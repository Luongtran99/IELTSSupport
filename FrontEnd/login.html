<!doctype html>
<html lang="en">
  <head>
    <title>SupportIELTS</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="https://media.geeksforgeeks.org/wp-content/cdn-uploads/gfg_200X200.png" tyle="image/x-icon" >

    <link rel="stylesheet" href="/css/style.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
  <body style="height: 100%">
    <head style="" style="display:flex;">
      <nav class="navheader">
        <div class="left">
          <div class="navelement">
            <a href="/index.html" style="color: black;font-size:1.5rem;font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;width: 50px;">
              <div style="width: 50px;">
                <b style="color:red">IELTS<span style="background-color: red;color:white">Support</span></b>
              </div>
            </a>
          </div>
        </div>
        <div style="display:flex;justify-content: center;">
          <div class="navelement">
            <a href="/index.html" style="color: black;font-size:1.5rem">MainPage</a>
          </div>
          <div class="navelement">
            <a href="#" style="color: black;font-size:1.5rem" data-toggle="dropdown">Features</a>
              <ul class="dropdown-menu">
                <div style="margin:5px">
                  <a href="#">Translate</a>
                  <hr>
                  <a href="#">Writing IELTS</a>
                </div>
              </ul>
          </div>
          <div class="navelement">
            <a href="#" style="color: black;font-size:1.5rem">Docs</a>
          </div>
          <div class="navelement">
            <a href="#" style="color: black;font-size:1.5rem">About</a>
          </div>
        </div>
        
        <div class="right" style="text-align: right;">
          <div class="navelement">
              <a href="/register.html" style="color: black;font-size:1.5rem; margin:10px">
                Register
              </a>
          </div>
        </div>
      </nav>
    </head>
    <main style="width:100%;height: 100%;background-color:white">
        <div style="width: 100%;display:flex;justify-content: center;align-items: center;height: 600px;">
          <div style="display:flex;width: 970px;background-color: aqua;height: 570px;border-radius: 10px;margin-top:30px">
            <div style="width: 50%;border-style: hidden;">
              <img src="/images/unnamed.jpg" style="height: 100%;width: 100%;border-style:ridge;">
            </div>
            <div style="width: 50%;border-style:none;height: 100%;background-color:#9eec8b;display: flex;justify-content: center;align-items: center;">
              <form style="height: 400px;width: 300px;" id="login-form">
                <div class="form-group">
                  <h3 style="font-style: oblique;
                  font-family: Georgia, 'Times New Roman', Times, serif;
                  font-weight: 1000;">Welcome to IELTSSupport</h3>
                </div>
                <div class="form-group">
                  <label>Username</label>
                  <input class="form-control" type="text" id="username" required>
                </div>
                <div class="form-group">
                  <label>Password</label>
                  <input class="form-control" type="password" id="password" required>
                </div>
                <div style="width: 100%; display:flex;justify-content: center;align-items: center;margin-top:30px">
                  <button type="submit" class="btn btn-light" style="width: 50%;">Login</button>
                </div>

                <div style="margin-top: 20px;display:flex;justify-content: center;width: 100%;">
                  You don't have an account, <a href="/register.html">Signup</a>
                </div>
              </form>
            </div>
          </div>
        </div>  
    </main>

    <!-- Login form-->
    <script type="text/javascript">

      // event check 
      if(localStorage.getItem("token") != null)
      {
        var getRightHeading = document.querySelector(".right");
        getRightHeading.innerHTML = "<div class=\"navelement\">"+
          "<a href=\"/index.html\" onclick=\"localStorage.clear()\" style=\"color: black;font-size:1.5rem; margin:10px\">Logout</a></div>";
      }

      // Event login submit 
      var x = document.querySelector("#login-form");
      x.addEventListener("submit", function(event)
      {
        event.preventDefault();
        var myHeader = new Headers();
        myHeader.append("Content-Type","application/json");

        // get value to body 
        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;

        var _body = JSON.stringify({
          "username":username,
          "password":password
        });

        var requestOptions = {
          method: "POST",
          headers:myHeader,
          body: _body,
          redirect: "follow"
        };

        fetch("https://localhost:44391/api/account/login", requestOptions)
        .then(response => response.json())
        .then(result => {
          if(result.isSuccess){
            localStorage.setItem("accessToken", result.token);
            window.location.replace("/essays.html");          
          }
        })
        .catch(error => console.log(error))
      })
    
  
    

    </script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </body>
</html>